<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- Primary Meta Tags -->
        <title>
            {% block title %}{{ page_title }}{% endblock %} | {{ site_name }}
        </title>
        <meta
            name="title"
            content="{% block meta_title %}{{ page_title }} | {{ site_name }}{% endblock %}"
        />
        <meta
            name="description"
            content="{% block description %}{{ meta_description }}{% endblock %}"
        />
        <meta
            name="keywords"
            content="{% block keywords %}{{ meta_keywords }}{% endblock %}"
        />
        <meta name="author" content="{{ site_name }}" />
        <meta name="robots" content="index, follow" />
        <link rel="canonical" href="{{ canonical_url }}" />

        <!-- Open Graph / Facebook -->
        <meta
            property="og:type"
            content="{% block og_type %}website{% endblock %}"
        />
        <meta property="og:url" content="{{ canonical_url }}" />
        <meta
            property="og:title"
            content="{% block og_title %}{{ page_title }} | {{ site_name }}{% endblock %}"
        />
        <meta
            property="og:description"
            content="{% block og_description %}{{ meta_description }}{% endblock %}"
        />
        <meta
            property="og:image"
            content="{% block og_image %}{{ og_image }}{% endblock %}"
        />
        <meta property="og:site_name" content="{{ site_name }}" />
        <meta property="og:locale" content="en_US" />

        <!-- Twitter -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:url" content="{{ canonical_url }}" />
        <meta
            name="twitter:title"
            content="{% block twitter_title %}{{ page_title }} | {{ site_name }}{% endblock %}"
        />
        <meta
            name="twitter:description"
            content="{% block twitter_description %}{{ meta_description }}{% endblock %}"
        />
        <meta
            name="twitter:image"
            content="{% block twitter_image %}{{ og_image }}{% endblock %}"
        />

        <!-- Structured Data -->
        <script type="application/ld+json">
            {% block structured_data %}
            {
                "@context": "https://schema.org",
                "@type": "WebSite",
                "name": "{{ site_name }}",
                "url": "{{ base_url }}",
                "description": "{{ meta_description }}"
            }
            {% endblock %}
        </script>

        <!-- Favicon -->
        <link
            rel="icon"
            type="image/svg+xml"
            href="/static/images/favicon-32x32.png"
        />
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/static/images/apple-touch-icon.png"
        />

        <!-- Preconnect for performance -->
        <link rel="preconnect" href="{{ base_url }}" />

        <!-- Self-hosted IBM Plex fonts - Only preload critical regular weights -->
        <link
            rel="preload"
            href="/static/fonts/IBMPlexSans-Regular.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <link
            rel="preload"
            href="/static/fonts/IBMPlexSerif-Regular.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <link rel="stylesheet" href="/static/css/base.css" />
        <link rel="stylesheet" href="/static/css/fonts.css" />
        <link rel="stylesheet" href="/static/css/typography.css" />
        <link rel="stylesheet" href="/static/css/responsive.css" />
        <link rel="stylesheet" href="/static/css/main.css" />

        {% block head %}{% endblock %}
    </head>
    <body>
        <a href="#main-content" class="skip-link">Skip to main content</a>

        <header role="banner">
            {% block header %}
            <div class="container">
                <nav role="navigation" aria-label="Main navigation">
                    <a href="/" class="site-name">runpiper</a>
                </nav>
            </div>
            {% endblock %}
        </header>

        <main id="main-content" role="main">
            {% block content %}{% endblock %}
        </main>

        <footer role="contentinfo">
            {% block footer %}
            <p>
                &copy; {{ current_year }} {{ site_name }}. All rights reserved.
            </p>
            {% endblock %}
        </footer>

        {% block scripts %}{% endblock %}
    </body>
</html>
